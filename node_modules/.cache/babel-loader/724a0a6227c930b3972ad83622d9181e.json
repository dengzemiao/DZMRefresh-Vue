{"remainingRequest":"/Users/dengzemiao/Desktop/Project/web/test/DZMRefresh-Vue/node_modules/babel-loader/lib/index.js!/Users/dengzemiao/Desktop/Project/web/test/DZMRefresh-Vue/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/dengzemiao/Desktop/Project/web/test/DZMRefresh-Vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/dengzemiao/Desktop/Project/web/test/DZMRefresh-Vue/src/components/Refresh.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/dengzemiao/Desktop/Project/web/test/DZMRefresh-Vue/src/components/Refresh.vue","mtime":1639015441367},{"path":"/Users/dengzemiao/Desktop/Project/web/test/DZMRefresh-Vue/babel.config.js","mtime":1638929722220},{"path":"/Users/dengzemiao/Desktop/Project/web/test/DZMRefresh-Vue/node_modules/cache-loader/dist/cjs.js","mtime":1638929706862},{"path":"/Users/dengzemiao/Desktop/Project/web/test/DZMRefresh-Vue/node_modules/babel-loader/lib/index.js","mtime":1638929705530},{"path":"/Users/dengzemiao/Desktop/Project/web/test/DZMRefresh-Vue/node_modules/cache-loader/dist/cjs.js","mtime":1638929706862},{"path":"/Users/dengzemiao/Desktop/Project/web/test/DZMRefresh-Vue/node_modules/vue-loader/lib/index.js","mtime":1638929703393}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiB7CiAgICAvLyDmmK/lkKbmnInmm7TlpJrmlbDmja7vvIzmsqHmnInmm7TlpJrmlbDmja7liJnmmL7npLogJ+ayoeacieaVsOaNricg5YWD57Sg77yM5bm25LiN5Lya5YaN6LCD55So5Yqg6L295Zue6LCDCiAgICBpc01vcmVEYXRhOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgICJkZWZhdWx0IjogdHJ1ZQogICAgfSwKICAgIC8vIOWKoOi9veeKtuaAge+8jOiuvue9ruS4uuWKoOi9veS4re+8jOWImeS4jeS8mumHjeWkjeinpuWPkeWKoOi9veS6i+S7tgogICAgaXNMb2FkaW5nOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgICJkZWZhdWx0IjogZmFsc2UKICAgIH0sCiAgICAvLyDmmK/lkKblnKjliqDovb3lrozmiJDml7bvvIzmo4Dmn6XlvZPliY0gZm9vdGVyIOWFg+e0oOaYr+WQpuWcqOi/m+WFpeWKoOi9veiMg+WbtAogICAgLy8gaXNMb2FkaW5nIOiuvue9rueKtuaAgemcgOimgeaUvuWcqCBpc01vcmVEYXRhIOiuvue9rueKtuaAgeS5i+WQju+8jOWboOS4uumcgOimgeS8mOWFiOWIpOaWreaYr+WQpuacieaVsOaNrgogICAgaXNMb2FkaW5nV2F0Y2g6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgImRlZmF1bHQiOiBmYWxzZQogICAgfSwKICAgIC8vIOaYr+WQpuebkeWQrOeql+WPo+WPmOWMlu+8jOacieWPmOWMluWImeajgOafpeaYr+WQpui/m+WFpeWKoOi9veiMg+WbtAogICAgaXNPblJlc2l6ZTogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICAiZGVmYXVsdCI6IGZhbHNlCiAgICB9LAogICAgLy8g5rKh5pyJ5pWw5o2u5o+Q56S6CiAgICBub2RhdGE6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICAiZGVmYXVsdCI6ICfmsqHmnInmm7TlpJrmlbDmja7kuoYnCiAgICB9LAogICAgLy8g5bC+6YOo5pi+56S65aSa5bCR5q+U5L6L77yM5YiZ5Y+v5Lul6L+b5YWl5Yqg6L2977yM5pyA5aSnIDEKICAgIGZvb3RlclNjYWxlOiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgImRlZmF1bHQiOiAwLjMKICAgIH0sCiAgICAvLyDlsL7pg6jmoLflvI8KICAgIGZvb3RlclN0eWxlOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgImRlZmF1bHQiOiBmdW5jdGlvbiBfZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gbmV3IE9iamVjdCgpOwogICAgICB9CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgLy8g55uR5ZCs5Yqg6L2954q25oCBCiAgICBpc0xvYWRpbmc6IHsKICAgICAgaGFuZGxlcjogZnVuY3Rpb24gaGFuZGxlcihuZXdEYXRhKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgICAgLy8g5piv5ZCm5YWB6K645qOA5p+l5b2T5YmNIGZvb3RlciDlnKjov5vlhaXliqDovb3ojIPlm7TlhoUKICAgICAgICAvLyDms6jmhI/vvJrlpoLmnpwgcmVmcmVzaC12aWV3IOWFg+e0oOacieiuvue9riBwYWRkaW5nLWJvdHRvbSDlgLzvvIzov5vlhaXliqDovb3ojIPlm7TpnIDopoHotoXlh7ogcGFkZGluZy1ib3R0b20g5YC877yM6byg5qCH5a6h5p+l5YWD57Sg56e75Yiw5YWD57Sg6Lqr5LiK77yM5YiZ5Y+v5Lul55yL5YiwIGZvb3RlciDlhYPntKDmmK/lkKblt7Lnu4/mu5rliLAgcGFkZGluZy1ib3R0b20g5YC85LmL5LiK5LqG44CCCiAgICAgICAgaWYgKHRoaXMuaXNMb2FkaW5nV2F0Y2gpIHsKICAgICAgICAgIC8vIOS4uiBmYWxzZSDml7bliJnnrpfliqDovb3lrozmiJAKICAgICAgICAgIGlmICghbmV3RGF0YSkgewogICAgICAgICAgICAvLyDlu7bov5/osIPnlKgKICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIC8vIOaJi+WKqOinpuWPkea7muWKqAogICAgICAgICAgICAgIF90aGlzLnNjcm9sbENoYW5nZSgpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICAvLyDojrflj5bmu5rliqjlhYPntKAKICAgIHZhciBzY3JvbGx2aWV3ID0gdGhpcy4kcmVmc1sncmVmcmVzaC12aWV3J107IC8vIOa3u+WKoOaLluaLvea7muWKqOadoeebkeWQrAoKICAgIHNjcm9sbHZpZXcuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5zY3JvbGxDaGFuZ2UsIHRydWUpOyAvLyDnm5HlkKznqpflj6Plj5jljJYKCiAgICBpZiAodGhpcy5pc09uUmVzaXplKSB7CiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLm9uUmVzaXplKTsKICAgIH0KICB9LAogIC8vIGJlZm9yZURlc3Ryb3kg5LiOIGRlc3Ryb3llZCDph4zpnaLnp7vpmaTpg73ooYwKICBiZWZvcmVEZXN0cm95OiBmdW5jdGlvbiBiZWZvcmVEZXN0cm95KCkgewogICAgLy8g6I635Y+W5oyH5a6a5YWD57SgCiAgICB2YXIgc2Nyb2xsdmlldyA9IHRoaXMuJHJlZnNbJ3JlZnJlc2gtdmlldyddOyAvLyDnp7vpmaTnm5HlkKwKCiAgICBzY3JvbGx2aWV3LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMuc2Nyb2xsQ2hhbmdlLCB0cnVlKTsgLy8g56e76Zmk56qX5Y+j55uR5ZCsCgogICAgaWYgKHRoaXMuaXNPblJlc2l6ZSkgewogICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5vblJlc2l6ZSk7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyDnqpflj6Plj5jljJYKICAgIG9uUmVzaXplOiBmdW5jdGlvbiBvblJlc2l6ZSgpIHsKICAgICAgLy8g5omL5Yqo6Kem5Y+R5rua5YqoCiAgICAgIHRoaXMuc2Nyb2xsQ2hhbmdlKCk7CiAgICB9LAogICAgLy8g5rua5Yqo55uR5ZCsCiAgICBzY3JvbGxDaGFuZ2U6IGZ1bmN0aW9uIHNjcm9sbENoYW5nZSgpIHsKICAgICAgLy8g5pyJ5pWw5o2uICYmIOayoeacieWcqOWKoOi9vQogICAgICBpZiAodGhpcy5pc01vcmVEYXRhICYmICF0aGlzLmlzTG9hZGluZykgewogICAgICAgIC8vIOiOt+WPluWuueWZqOWvueixoQogICAgICAgIHZhciByZWZyZXNoVmlldyA9IHRoaXMuJHJlZnNbJ3JlZnJlc2gtdmlldyddOwogICAgICAgIHZhciBmb290ZXJWaWV3ID0gdGhpcy4kcmVmc1sncmVmcmVzaC1mb290ZXInXTsgLy8g6I635Y+W5a655Zmo6auY5bqmCgogICAgICAgIHZhciBjbGllbnRIZWlnaHQgPSByZWZyZXNoVmlldy5jbGllbnRIZWlnaHQ7IC8vIOiOt+WPluWuueWZqOa7muWKqOmrmOW6pgoKICAgICAgICB2YXIgc2Nyb2xsSGVpZ2h0ID0gcmVmcmVzaFZpZXcuc2Nyb2xsSGVpZ2h0OyAvLyDlvZPliY3mu5rliqjlrrnlmajpobbkuIrlnZDmoIfkvY3nva4KCiAgICAgICAgdmFyIG1pbnkgPSByZWZyZXNoVmlldy5zY3JvbGxUb3A7IC8vIOW9k+WJjea7muWKqOWuueWZqOW6lemDqOWdkOagh+S9jee9rgoKICAgICAgICB2YXIgbWF4eSA9IG1pbnkgKyBjbGllbnRIZWlnaHQ7IC8vIOW6lemDqOmrmOW6pgoKICAgICAgICB2YXIgZm9vdGVySGVpZ2h0ID0gZm9vdGVyVmlldy5jbGllbnRIZWlnaHQ7IC8vIOW6lemDqOS4jeWPr+ingemrmOW6pgoKICAgICAgICB2YXIgZm9vdGVySGlkZUhlaWdodCA9ICgxIC0gTWF0aC5taW4oMSwgdGhpcy5mb290ZXJTY2FsZSkpICogZm9vdGVySGVpZ2h0OyAvLyDov5vlhaXliqDovb3nmoTmnIDlpKflnZDmoIfkvY3nva7vvIzlpJrlh4/lsJHkuKogMXB4IO+8jOS+v+S6juS4jeebuOetiQoKICAgICAgICB2YXIgbG9hZGluZ3kgPSBzY3JvbGxIZWlnaHQgLSBmb290ZXJIaWRlSGVpZ2h0IC0gMTsgLy8g5piv5ZCm6L+b5YWl5Yqg6L296IyD5Zu0CgogICAgICAgIGlmIChtYXh5ID49IGxvYWRpbmd5KSB7CiAgICAgICAgICAvLyDov5vlhaXliqDovb0KICAgICAgICAgIHRoaXMuJGVtaXQoJ2xvYWRpbmcnKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn07"},{"version":3,"sources":["Refresh.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <!-- 容器 -->\n  <div\n    class=\"refresh-view\"\n    ref=\"refresh-view\"\n    @mousewheel=\"scrollChange\"\n  >\n    <!-- 内容 -->\n    <slot></slot>\n    <!-- 尾部 -->\n    <div\n      class=\"refresh-footer\"\n      ref=\"refresh-footer\"\n    >\n      <!-- 可自定义尾部 -->\n      <slot\n        name=\"footer\"\n        :isMoreData=\"isMoreData\"\n        :isLoading=\"isLoading\"\n        :footerStyle=\"footerStyle\"\n        :nodata=\"nodata\"\n      >\n        <!-- 默认尾部元素 -->\n        <div\n          class=\"footer-content\"\n          :style=\"footerStyle\"\n        >\n          <!-- 加载中... -->\n          <slot name=\"loading\" v-if=\"isMoreData\">加载中...</slot>\n          <!-- 没有数据 -->\n          <slot name=\"nodata\" v-else>{{ nodata }}</slot>\n        </div>\n      </slot>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  props: {\n    // 是否有更多数据，没有更多数据则显示 '没有数据' 元素，并不会再调用加载回调\n    isMoreData: {\n      type: Boolean,\n      default: true\n    },\n    // 加载状态，设置为加载中，则不会重复触发加载事件\n    isLoading: {\n      type: Boolean,\n      default: false\n    },\n    // 是否在加载完成时，检查当前 footer 元素是否在进入加载范围\n    // isLoading 设置状态需要放在 isMoreData 设置状态之后，因为需要优先判断是否有数据\n    isLoadingWatch: {\n      type: Boolean,\n      default: false\n    },\n    // 是否监听窗口变化，有变化则检查是否进入加载范围\n    isOnResize: {\n      type: Boolean,\n      default: false\n    },\n    // 没有数据提示\n    nodata: {\n      type: String,\n      default: '没有更多数据了'\n    },\n    // 尾部显示多少比例，则可以进入加载，最大 1\n    footerScale: {\n      type: Number,\n      default: 0.3\n    },\n    // 尾部样式\n    footerStyle: {\n      type: Object,\n      default: () => { return new Object() }\n    }\n  },\n  watch: {\n    // 监听加载状态\n    isLoading: {\n      handler (newData) {\n      // 是否允许检查当前 footer 在进入加载范围内\n      // 注意：如果 refresh-view 元素有设置 padding-bottom 值，进入加载范围需要超出 padding-bottom 值，鼠标审查元素移到元素身上，则可以看到 footer 元素是否已经滚到 padding-bottom 值之上了。\n      if (this.isLoadingWatch) {\n          // 为 false 时则算加载完成\n          if (!newData) {\n            // 延迟调用\n            this.$nextTick(() => {\n              // 手动触发滚动\n              this.scrollChange()\n            })\n          }\n        }\n      }\n    }\n  },\n  mounted () {\n    // 获取滚动元素\n    const scrollview = this.$refs['refresh-view']\n    // 添加拖拽滚动条监听\n    scrollview.addEventListener('scroll', this.scrollChange, true)\n    // 监听窗口变化\n    if (this.isOnResize) { window.addEventListener('resize', this.onResize) }\n  },\n  // beforeDestroy 与 destroyed 里面移除都行\n  beforeDestroy () {\n    // 获取指定元素\n    const scrollview = this.$refs['refresh-view']\n    // 移除监听\n    scrollview.removeEventListener('scroll', this.scrollChange, true)\n    // 移除窗口监听\n    if (this.isOnResize) { window.removeEventListener('resize', this.onResize) }\n  },\n  methods: {\n    // 窗口变化\n    onResize () {\n      // 手动触发滚动\n      this.scrollChange()\n    },\n    // 滚动监听\n    scrollChange () {\n      // 有数据 && 没有在加载\n      if (this.isMoreData && !this.isLoading) {\n        // 获取容器对象\n        const refreshView = this.$refs['refresh-view']\n        const footerView = this.$refs['refresh-footer']\n        // 获取容器高度\n        const clientHeight = refreshView.clientHeight\n        // 获取容器滚动高度\n        const scrollHeight = refreshView.scrollHeight\n        // 当前滚动容器顶上坐标位置\n        const miny = refreshView.scrollTop\n        // 当前滚动容器底部坐标位置\n        const maxy = miny + clientHeight\n        // 底部高度\n        const footerHeight = footerView.clientHeight\n        // 底部不可见高度\n        const footerHideHeight = (1 - Math.min(1, this.footerScale)) * footerHeight\n        // 进入加载的最大坐标位置，多减少个 1px ，便于不相等\n        const loadingy = scrollHeight - footerHideHeight - 1\n        // 是否进入加载范围\n        if (maxy >= loadingy) {\n          // 进入加载\n          this.$emit('loading')\n        }\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.refresh-view {\n  width: 100%;\n  height: 100%;\n  overflow-y: auto;\n}\n.refresh-footer {\n  width: 100%;\n}\n.footer-content {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: rgba(0,0,0,.65);\n  font-size: 14px;\n  width: 100%;\n  height: 48px;\n}\n</style>"],"sourceRoot":"src/components"}]}