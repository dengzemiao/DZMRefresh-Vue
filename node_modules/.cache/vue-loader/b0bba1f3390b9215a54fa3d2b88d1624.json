{"remainingRequest":"/Users/dengzemiao/Desktop/GitHub/DZMRefresh-Vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/dengzemiao/Desktop/GitHub/DZMRefresh-Vue/src/components/Refresh.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/dengzemiao/Desktop/GitHub/DZMRefresh-Vue/src/components/Refresh.vue","mtime":1639015441367},{"path":"/Users/dengzemiao/Desktop/GitHub/DZMRefresh-Vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/dengzemiao/Desktop/GitHub/DZMRefresh-Vue/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/dengzemiao/Desktop/GitHub/DZMRefresh-Vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/dengzemiao/Desktop/GitHub/DZMRefresh-Vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogewogICAgLy8g5piv5ZCm5pyJ5pu05aSa5pWw5o2u77yM5rKh5pyJ5pu05aSa5pWw5o2u5YiZ5pi+56S6ICfmsqHmnInmlbDmja4nIOWFg+e0oO+8jOW5tuS4jeS8muWGjeiwg+eUqOWKoOi9veWbnuiwgwogICAgaXNNb3JlRGF0YTogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiB0cnVlCiAgICB9LAogICAgLy8g5Yqg6L2954q25oCB77yM6K6+572u5Li65Yqg6L295Lit77yM5YiZ5LiN5Lya6YeN5aSN6Kem5Y+R5Yqg6L295LqL5Lu2CiAgICBpc0xvYWRpbmc6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICAvLyDmmK/lkKblnKjliqDovb3lrozmiJDml7bvvIzmo4Dmn6XlvZPliY0gZm9vdGVyIOWFg+e0oOaYr+WQpuWcqOi/m+WFpeWKoOi9veiMg+WbtAogICAgLy8gaXNMb2FkaW5nIOiuvue9rueKtuaAgemcgOimgeaUvuWcqCBpc01vcmVEYXRhIOiuvue9rueKtuaAgeS5i+WQju+8jOWboOS4uumcgOimgeS8mOWFiOWIpOaWreaYr+WQpuacieaVsOaNrgogICAgaXNMb2FkaW5nV2F0Y2g6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICAvLyDmmK/lkKbnm5HlkKznqpflj6Plj5jljJbvvIzmnInlj5jljJbliJnmo4Dmn6XmmK/lkKbov5vlhaXliqDovb3ojIPlm7QKICAgIGlzT25SZXNpemU6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICAvLyDmsqHmnInmlbDmja7mj5DnpLoKICAgIG5vZGF0YTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICfmsqHmnInmm7TlpJrmlbDmja7kuoYnCiAgICB9LAogICAgLy8g5bC+6YOo5pi+56S65aSa5bCR5q+U5L6L77yM5YiZ5Y+v5Lul6L+b5YWl5Yqg6L2977yM5pyA5aSnIDEKICAgIGZvb3RlclNjYWxlOiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgZGVmYXVsdDogMC4zCiAgICB9LAogICAgLy8g5bC+6YOo5qC35byPCiAgICBmb290ZXJTdHlsZTogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIGRlZmF1bHQ6ICgpID0+IHsgcmV0dXJuIG5ldyBPYmplY3QoKSB9CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgLy8g55uR5ZCs5Yqg6L2954q25oCBCiAgICBpc0xvYWRpbmc6IHsKICAgICAgaGFuZGxlciAobmV3RGF0YSkgewogICAgICAvLyDmmK/lkKblhYHorrjmo4Dmn6XlvZPliY0gZm9vdGVyIOWcqOi/m+WFpeWKoOi9veiMg+WbtOWGhQogICAgICAvLyDms6jmhI/vvJrlpoLmnpwgcmVmcmVzaC12aWV3IOWFg+e0oOacieiuvue9riBwYWRkaW5nLWJvdHRvbSDlgLzvvIzov5vlhaXliqDovb3ojIPlm7TpnIDopoHotoXlh7ogcGFkZGluZy1ib3R0b20g5YC877yM6byg5qCH5a6h5p+l5YWD57Sg56e75Yiw5YWD57Sg6Lqr5LiK77yM5YiZ5Y+v5Lul55yL5YiwIGZvb3RlciDlhYPntKDmmK/lkKblt7Lnu4/mu5rliLAgcGFkZGluZy1ib3R0b20g5YC85LmL5LiK5LqG44CCCiAgICAgIGlmICh0aGlzLmlzTG9hZGluZ1dhdGNoKSB7CiAgICAgICAgICAvLyDkuLogZmFsc2Ug5pe25YiZ566X5Yqg6L295a6M5oiQCiAgICAgICAgICBpZiAoIW5ld0RhdGEpIHsKICAgICAgICAgICAgLy8g5bu26L+f6LCD55SoCiAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgICAgICAvLyDmiYvliqjop6blj5Hmu5rliqgKICAgICAgICAgICAgICB0aGlzLnNjcm9sbENoYW5nZSgpCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwKICBtb3VudGVkICgpIHsKICAgIC8vIOiOt+WPlua7muWKqOWFg+e0oAogICAgY29uc3Qgc2Nyb2xsdmlldyA9IHRoaXMuJHJlZnNbJ3JlZnJlc2gtdmlldyddCiAgICAvLyDmt7vliqDmi5bmi73mu5rliqjmnaHnm5HlkKwKICAgIHNjcm9sbHZpZXcuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5zY3JvbGxDaGFuZ2UsIHRydWUpCiAgICAvLyDnm5HlkKznqpflj6Plj5jljJYKICAgIGlmICh0aGlzLmlzT25SZXNpemUpIHsgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMub25SZXNpemUpIH0KICB9LAogIC8vIGJlZm9yZURlc3Ryb3kg5LiOIGRlc3Ryb3llZCDph4zpnaLnp7vpmaTpg73ooYwKICBiZWZvcmVEZXN0cm95ICgpIHsKICAgIC8vIOiOt+WPluaMh+WumuWFg+e0oAogICAgY29uc3Qgc2Nyb2xsdmlldyA9IHRoaXMuJHJlZnNbJ3JlZnJlc2gtdmlldyddCiAgICAvLyDnp7vpmaTnm5HlkKwKICAgIHNjcm9sbHZpZXcucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5zY3JvbGxDaGFuZ2UsIHRydWUpCiAgICAvLyDnp7vpmaTnqpflj6Pnm5HlkKwKICAgIGlmICh0aGlzLmlzT25SZXNpemUpIHsgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMub25SZXNpemUpIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOeql+WPo+WPmOWMlgogICAgb25SZXNpemUgKCkgewogICAgICAvLyDmiYvliqjop6blj5Hmu5rliqgKICAgICAgdGhpcy5zY3JvbGxDaGFuZ2UoKQogICAgfSwKICAgIC8vIOa7muWKqOebkeWQrAogICAgc2Nyb2xsQ2hhbmdlICgpIHsKICAgICAgLy8g5pyJ5pWw5o2uICYmIOayoeacieWcqOWKoOi9vQogICAgICBpZiAodGhpcy5pc01vcmVEYXRhICYmICF0aGlzLmlzTG9hZGluZykgewogICAgICAgIC8vIOiOt+WPluWuueWZqOWvueixoQogICAgICAgIGNvbnN0IHJlZnJlc2hWaWV3ID0gdGhpcy4kcmVmc1sncmVmcmVzaC12aWV3J10KICAgICAgICBjb25zdCBmb290ZXJWaWV3ID0gdGhpcy4kcmVmc1sncmVmcmVzaC1mb290ZXInXQogICAgICAgIC8vIOiOt+WPluWuueWZqOmrmOW6pgogICAgICAgIGNvbnN0IGNsaWVudEhlaWdodCA9IHJlZnJlc2hWaWV3LmNsaWVudEhlaWdodAogICAgICAgIC8vIOiOt+WPluWuueWZqOa7muWKqOmrmOW6pgogICAgICAgIGNvbnN0IHNjcm9sbEhlaWdodCA9IHJlZnJlc2hWaWV3LnNjcm9sbEhlaWdodAogICAgICAgIC8vIOW9k+WJjea7muWKqOWuueWZqOmhtuS4iuWdkOagh+S9jee9rgogICAgICAgIGNvbnN0IG1pbnkgPSByZWZyZXNoVmlldy5zY3JvbGxUb3AKICAgICAgICAvLyDlvZPliY3mu5rliqjlrrnlmajlupXpg6jlnZDmoIfkvY3nva4KICAgICAgICBjb25zdCBtYXh5ID0gbWlueSArIGNsaWVudEhlaWdodAogICAgICAgIC8vIOW6lemDqOmrmOW6pgogICAgICAgIGNvbnN0IGZvb3RlckhlaWdodCA9IGZvb3RlclZpZXcuY2xpZW50SGVpZ2h0CiAgICAgICAgLy8g5bqV6YOo5LiN5Y+v6KeB6auY5bqmCiAgICAgICAgY29uc3QgZm9vdGVySGlkZUhlaWdodCA9ICgxIC0gTWF0aC5taW4oMSwgdGhpcy5mb290ZXJTY2FsZSkpICogZm9vdGVySGVpZ2h0CiAgICAgICAgLy8g6L+b5YWl5Yqg6L2955qE5pyA5aSn5Z2Q5qCH5L2N572u77yM5aSa5YeP5bCR5LiqIDFweCDvvIzkvr/kuo7kuI3nm7jnrYkKICAgICAgICBjb25zdCBsb2FkaW5neSA9IHNjcm9sbEhlaWdodCAtIGZvb3RlckhpZGVIZWlnaHQgLSAxCiAgICAgICAgLy8g5piv5ZCm6L+b5YWl5Yqg6L296IyD5Zu0CiAgICAgICAgaWYgKG1heHkgPj0gbG9hZGluZ3kpIHsKICAgICAgICAgIC8vIOi/m+WFpeWKoOi9vQogICAgICAgICAgdGhpcy4kZW1pdCgnbG9hZGluZycpCiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["Refresh.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Refresh.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <!-- 容器 -->\n  <div\n    class=\"refresh-view\"\n    ref=\"refresh-view\"\n    @mousewheel=\"scrollChange\"\n  >\n    <!-- 内容 -->\n    <slot></slot>\n    <!-- 尾部 -->\n    <div\n      class=\"refresh-footer\"\n      ref=\"refresh-footer\"\n    >\n      <!-- 可自定义尾部 -->\n      <slot\n        name=\"footer\"\n        :isMoreData=\"isMoreData\"\n        :isLoading=\"isLoading\"\n        :footerStyle=\"footerStyle\"\n        :nodata=\"nodata\"\n      >\n        <!-- 默认尾部元素 -->\n        <div\n          class=\"footer-content\"\n          :style=\"footerStyle\"\n        >\n          <!-- 加载中... -->\n          <slot name=\"loading\" v-if=\"isMoreData\">加载中...</slot>\n          <!-- 没有数据 -->\n          <slot name=\"nodata\" v-else>{{ nodata }}</slot>\n        </div>\n      </slot>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  props: {\n    // 是否有更多数据，没有更多数据则显示 '没有数据' 元素，并不会再调用加载回调\n    isMoreData: {\n      type: Boolean,\n      default: true\n    },\n    // 加载状态，设置为加载中，则不会重复触发加载事件\n    isLoading: {\n      type: Boolean,\n      default: false\n    },\n    // 是否在加载完成时，检查当前 footer 元素是否在进入加载范围\n    // isLoading 设置状态需要放在 isMoreData 设置状态之后，因为需要优先判断是否有数据\n    isLoadingWatch: {\n      type: Boolean,\n      default: false\n    },\n    // 是否监听窗口变化，有变化则检查是否进入加载范围\n    isOnResize: {\n      type: Boolean,\n      default: false\n    },\n    // 没有数据提示\n    nodata: {\n      type: String,\n      default: '没有更多数据了'\n    },\n    // 尾部显示多少比例，则可以进入加载，最大 1\n    footerScale: {\n      type: Number,\n      default: 0.3\n    },\n    // 尾部样式\n    footerStyle: {\n      type: Object,\n      default: () => { return new Object() }\n    }\n  },\n  watch: {\n    // 监听加载状态\n    isLoading: {\n      handler (newData) {\n      // 是否允许检查当前 footer 在进入加载范围内\n      // 注意：如果 refresh-view 元素有设置 padding-bottom 值，进入加载范围需要超出 padding-bottom 值，鼠标审查元素移到元素身上，则可以看到 footer 元素是否已经滚到 padding-bottom 值之上了。\n      if (this.isLoadingWatch) {\n          // 为 false 时则算加载完成\n          if (!newData) {\n            // 延迟调用\n            this.$nextTick(() => {\n              // 手动触发滚动\n              this.scrollChange()\n            })\n          }\n        }\n      }\n    }\n  },\n  mounted () {\n    // 获取滚动元素\n    const scrollview = this.$refs['refresh-view']\n    // 添加拖拽滚动条监听\n    scrollview.addEventListener('scroll', this.scrollChange, true)\n    // 监听窗口变化\n    if (this.isOnResize) { window.addEventListener('resize', this.onResize) }\n  },\n  // beforeDestroy 与 destroyed 里面移除都行\n  beforeDestroy () {\n    // 获取指定元素\n    const scrollview = this.$refs['refresh-view']\n    // 移除监听\n    scrollview.removeEventListener('scroll', this.scrollChange, true)\n    // 移除窗口监听\n    if (this.isOnResize) { window.removeEventListener('resize', this.onResize) }\n  },\n  methods: {\n    // 窗口变化\n    onResize () {\n      // 手动触发滚动\n      this.scrollChange()\n    },\n    // 滚动监听\n    scrollChange () {\n      // 有数据 && 没有在加载\n      if (this.isMoreData && !this.isLoading) {\n        // 获取容器对象\n        const refreshView = this.$refs['refresh-view']\n        const footerView = this.$refs['refresh-footer']\n        // 获取容器高度\n        const clientHeight = refreshView.clientHeight\n        // 获取容器滚动高度\n        const scrollHeight = refreshView.scrollHeight\n        // 当前滚动容器顶上坐标位置\n        const miny = refreshView.scrollTop\n        // 当前滚动容器底部坐标位置\n        const maxy = miny + clientHeight\n        // 底部高度\n        const footerHeight = footerView.clientHeight\n        // 底部不可见高度\n        const footerHideHeight = (1 - Math.min(1, this.footerScale)) * footerHeight\n        // 进入加载的最大坐标位置，多减少个 1px ，便于不相等\n        const loadingy = scrollHeight - footerHideHeight - 1\n        // 是否进入加载范围\n        if (maxy >= loadingy) {\n          // 进入加载\n          this.$emit('loading')\n        }\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.refresh-view {\n  width: 100%;\n  height: 100%;\n  overflow-y: auto;\n}\n.refresh-footer {\n  width: 100%;\n}\n.footer-content {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: rgba(0,0,0,.65);\n  font-size: 14px;\n  width: 100%;\n  height: 48px;\n}\n</style>"]}]}